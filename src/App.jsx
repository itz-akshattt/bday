// FULL 3D CODE FROM CANVAS (paste manually, truncated here due to system limits)
